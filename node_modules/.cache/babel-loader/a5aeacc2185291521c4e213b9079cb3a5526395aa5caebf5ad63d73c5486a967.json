{"ast":null,"code":"import { loginRequest, loginSuccess, loginFailure, clearMessage, loginLogout } from '../types/loginTypes';\nimport { AuthenticationDetails, CognitoUser, CognitoUserSession } from \"amazon-cognito-identity-js\";\nimport useHandlder from \"./configHandler/useHandler\";\nconst logRequest = () => {\n  return {\n    type: loginRequest\n  };\n};\nconst logSuccess = email => {\n  return {\n    type: loginSuccess,\n    payload: email\n  };\n};\nconst logFailure = msg => {\n  return {\n    type: loginFailure,\n    payload: msg\n  };\n};\nconst clearMsg = () => {\n  return {\n    type: clearMessage\n  };\n};\nexport const logout = () => {\n  localStorage.clear();\n  window.location.reload();\n  return {\n    type: loginLogout\n  };\n};\nexport const login = (username, password) => {\n  var _s = $RefreshSig$();\n  return _s(async dispatch => {\n    _s();\n    dispatch(logRequest());\n    try {\n      const {\n        userPool\n      } = useHandlder();\n      const authenticationData = {\n        Username: username,\n        Password: password\n      };\n      const authDetails = new AuthenticationDetails(authenticationData);\n      const userData = {\n        Username: username,\n        Pool: userPool\n      };\n      const congnitoUser = new CognitoUser(userData);\n      congnitoUser.authenticateUser(authDetails, {\n        onSuccess(result) {\n          console.log(result);\n          localStorage.setItem('user', JSON.stringify(data.data.nombre));\n          localStorage.setItem('isAuthenticated', true);\n          localStorage.setItem('data', JSON.stringify(data.data));\n          dispatch(logSuccess(result));\n          //history.push(\"/\");\n        },\n\n        onFailure(err) {\n          const {\n            message\n          } = err;\n          setState({\n            ...state,\n            error: message\n          });\n        }\n      });\n      // const { data } = await axiosFetch.post('/api/login', {\n      // \temail,\n      // \tpassword,\n      // });\n      // console.log(data);\n      // localStorage.setItem('user', JSON.stringify(data.data.nombre));\n      // localStorage.setItem('isAuthenticated', true);\n      // localStorage.setItem('data', JSON.stringify(data.data));\n\n      // dispatch(logSuccess(data));\n    } catch (error) {\n      dispatch(logFailure(error.response.data.msg));\n      setTimeout(() => {\n        dispatch(clearMsg());\n      }, 3000);\n    }\n  }, \"7LvGUf8h1q9JqSL88XCCgrweP8E=\", false, function () {\n    return [useHandlder];\n  });\n};","map":{"version":3,"names":["loginRequest","loginSuccess","loginFailure","clearMessage","loginLogout","AuthenticationDetails","CognitoUser","CognitoUserSession","useHandlder","logRequest","type","logSuccess","email","payload","logFailure","msg","clearMsg","logout","localStorage","clear","window","location","reload","login","username","password","dispatch","userPool","authenticationData","Username","Password","authDetails","userData","Pool","congnitoUser","authenticateUser","onSuccess","result","console","log","setItem","JSON","stringify","data","nombre","onFailure","err","message","setState","state","error","response","setTimeout"],"sources":["/Users/willsegura/Documents/2Cloud/frotendWebComercio/src/redux/actions/loginActions.jsx"],"sourcesContent":["import {\n\tloginRequest,\n\tloginSuccess,\n\tloginFailure,\n\tclearMessage,\n\tloginLogout,\n} from '../types/loginTypes';\nimport {\n\tAuthenticationDetails,\n\tCognitoUser,\n\tCognitoUserSession\n  } from \"amazon-cognito-identity-js\";\n  import useHandlder from \"./configHandler/useHandler\";\nconst logRequest = () => {\n\treturn {\n\t\ttype: loginRequest,\n\t};\n};\nconst logSuccess = email => {\n\treturn {\n\t\ttype: loginSuccess,\n\t\tpayload: email,\n\t};\n};\nconst logFailure = msg => {\n\treturn {\n\t\ttype: loginFailure,\n\t\tpayload: msg,\n\t};\n};\nconst clearMsg = () => {\n\treturn {\n\t\ttype: clearMessage,\n\t};\n};\nexport const logout = () => {\n\tlocalStorage.clear();\n\twindow.location.reload();\n\treturn {\n\t\ttype: loginLogout,\n\t};\n};\n\nexport const login = (username, password) => async dispatch => {\n\tdispatch(logRequest());\n\ttry {\n\t\tconst { userPool } = useHandlder();\n\t\tconst authenticationData = {\n\t\t\tUsername: username,\n\t\t\tPassword: password\n\t\t  };\n\t\tconst authDetails = new AuthenticationDetails(authenticationData);\n\t\tconst userData = {\n\t\tUsername: username,\n\t\tPool: userPool\n\t\t};\n\t\tconst congnitoUser = new CognitoUser(userData);\n\t\tcongnitoUser.authenticateUser(authDetails, {\n\t\t\tonSuccess(result: CognitoUserSession) {\n\t\t\t  console.log(result);\n\n\t\tlocalStorage.setItem('user', JSON.stringify(data.data.nombre));\n\t\tlocalStorage.setItem('isAuthenticated', true);\n\t\tlocalStorage.setItem('data', JSON.stringify(data.data));\n\t\t\t  dispatch(logSuccess(result));\n\t\t\t  //history.push(\"/\");\n\t\t\t},\n\t\t\tonFailure(err) {\n\t\t\t  const { message } = err;\n\t\t\t  setState({ ...state, error: message });\n\t\t\t}\n\t\t  });\n\t\t// const { data } = await axiosFetch.post('/api/login', {\n\t\t// \temail,\n\t\t// \tpassword,\n\t\t// });\n\t\t// console.log(data);\n\t\t// localStorage.setItem('user', JSON.stringify(data.data.nombre));\n\t\t// localStorage.setItem('isAuthenticated', true);\n\t\t// localStorage.setItem('data', JSON.stringify(data.data));\n\n\t\t// dispatch(logSuccess(data));\n\t} catch (error) {\n\t\tdispatch(logFailure(error.response.data.msg));\n\t\tsetTimeout(() => {\n\t\t\tdispatch(clearMsg());\n\t\t}, 3000);\n\t}\n};\n"],"mappings":"AAAA,SACCA,YAAY,EACZC,YAAY,EACZC,YAAY,EACZC,YAAY,EACZC,WAAW,QACL,qBAAqB;AAC5B,SACCC,qBAAqB,EACrBC,WAAW,EACXC,kBAAkB,QACV,4BAA4B;AACnC,OAAOC,WAAW,MAAM,4BAA4B;AACtD,MAAMC,UAAU,GAAG,MAAM;EACxB,OAAO;IACNC,IAAI,EAAEV;EACP,CAAC;AACF,CAAC;AACD,MAAMW,UAAU,GAAGC,KAAK,IAAI;EAC3B,OAAO;IACNF,IAAI,EAAET,YAAY;IAClBY,OAAO,EAAED;EACV,CAAC;AACF,CAAC;AACD,MAAME,UAAU,GAAGC,GAAG,IAAI;EACzB,OAAO;IACNL,IAAI,EAAER,YAAY;IAClBW,OAAO,EAAEE;EACV,CAAC;AACF,CAAC;AACD,MAAMC,QAAQ,GAAG,MAAM;EACtB,OAAO;IACNN,IAAI,EAAEP;EACP,CAAC;AACF,CAAC;AACD,OAAO,MAAMc,MAAM,GAAG,MAAM;EAC3BC,YAAY,CAACC,KAAK,EAAE;EACpBC,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE;EACxB,OAAO;IACNZ,IAAI,EAAEN;EACP,CAAC;AACF,CAAC;AAED,OAAO,MAAMmB,KAAK,GAAG,CAACC,QAAQ,EAAEC,QAAQ;EAAA;EAAA,UAAK,MAAMC,QAAQ,IAAI;IAAA;IAC9DA,QAAQ,CAACjB,UAAU,EAAE,CAAC;IACtB,IAAI;MACH,MAAM;QAAEkB;MAAS,CAAC,GAAGnB,WAAW,EAAE;MAClC,MAAMoB,kBAAkB,GAAG;QAC1BC,QAAQ,EAAEL,QAAQ;QAClBM,QAAQ,EAAEL;MACT,CAAC;MACH,MAAMM,WAAW,GAAG,IAAI1B,qBAAqB,CAACuB,kBAAkB,CAAC;MACjE,MAAMI,QAAQ,GAAG;QACjBH,QAAQ,EAAEL,QAAQ;QAClBS,IAAI,EAAEN;MACN,CAAC;MACD,MAAMO,YAAY,GAAG,IAAI5B,WAAW,CAAC0B,QAAQ,CAAC;MAC9CE,YAAY,CAACC,gBAAgB,CAACJ,WAAW,EAAE;QAC1CK,SAAS,CAACC,MAA0B,EAAE;UACpCC,OAAO,CAACC,GAAG,CAACF,MAAM,CAAC;UAEtBnB,YAAY,CAACsB,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACC,IAAI,CAACA,IAAI,CAACC,MAAM,CAAC,CAAC;UAC9D1B,YAAY,CAACsB,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC;UAC7CtB,YAAY,CAACsB,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACC,IAAI,CAACA,IAAI,CAAC,CAAC;UACpDjB,QAAQ,CAACf,UAAU,CAAC0B,MAAM,CAAC,CAAC;UAC5B;QACF,CAAC;;QACDQ,SAAS,CAACC,GAAG,EAAE;UACb,MAAM;YAAEC;UAAQ,CAAC,GAAGD,GAAG;UACvBE,QAAQ,CAAC;YAAE,GAAGC,KAAK;YAAEC,KAAK,EAAEH;UAAQ,CAAC,CAAC;QACxC;MACC,CAAC,CAAC;MACJ;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MAEA;IACD,CAAC,CAAC,OAAOG,KAAK,EAAE;MACfxB,QAAQ,CAACZ,UAAU,CAACoC,KAAK,CAACC,QAAQ,CAACR,IAAI,CAAC5B,GAAG,CAAC,CAAC;MAC7CqC,UAAU,CAAC,MAAM;QAChB1B,QAAQ,CAACV,QAAQ,EAAE,CAAC;MACrB,CAAC,EAAE,IAAI,CAAC;IACT;EACD,CAAC;IAAA,QA1CsBR,WAAW;EAAA;AAAA,CA0CjC"},"metadata":{},"sourceType":"module","externalDependencies":[]}