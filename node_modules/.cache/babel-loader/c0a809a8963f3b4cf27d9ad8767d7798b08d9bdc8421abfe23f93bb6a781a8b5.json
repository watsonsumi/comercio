{"ast":null,"code":"import _regeneratorRuntime from\"/Users/willsegura/Documents/comercio/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/willsegura/Documents/comercio/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{loginRequest,loginSuccess,loginFailure,clearMessage,loginLogout}from'../types/loginTypes';import{AuthenticationDetails,CognitoUser,CognitoUserSession,CognitoUserPool}from\"amazon-cognito-identity-js\";//   import UseHandler from \"../../config/UseHandler\";\nvar Pool_Data={UserPoolId:'us-east-1_WN7mX5v6o',// Your user pool id here\nClientId:'556ootgckn7idfhepo7c0up52g'};var userPool=new CognitoUserPool(Pool_Data);var logRequest=function logRequest(){return{type:loginRequest};};var logSuccess=function logSuccess(email){return{type:loginSuccess,payload:email};};var logFailure=function logFailure(msg){return{type:loginFailure,payload:msg};};var clearMsg=function clearMsg(){return{type:clearMessage};};export var logout=function logout(){localStorage.clear();window.location.reload();return{type:loginLogout};};export var login=function login(username,password){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var authenticationData,authDetails,userData,congnitoUser;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:dispatch(logRequest());try{authenticationData={Username:username,Password:password};console.log(authenticationData);authDetails=new AuthenticationDetails(authenticationData);//Encapsula todos los datos necesarios para autenticar a un usuario. \n//Pase un objeto de este tipo al objeto de continuación para continuar con el proceso de autenticación. Este contenido de este objeto se establece cuando se construye y es inmutable después.\nuserData={Username:username,Pool:userPool};congnitoUser=new CognitoUser(userData);congnitoUser.authenticateUser(authDetails,{onSuccess:function onSuccess(result){//me da una sesión, de la que puedo obtener un jwtToken\nconsole.log(result);console.log(CognitoUserSession);localStorage.setItem('Token',JSON.stringify(result.accessToken.jwtToken));localStorage.setItem('isAuthenticated',true);localStorage.setItem('data',JSON.stringify(result));dispatch(logSuccess(result));}});}catch(error){dispatch(logFailure(error));setTimeout(function(){dispatch(clearMsg());},3000);}case 2:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};","map":{"version":3,"names":["loginRequest","loginSuccess","loginFailure","clearMessage","loginLogout","AuthenticationDetails","CognitoUser","CognitoUserSession","CognitoUserPool","Pool_Data","UserPoolId","ClientId","userPool","logRequest","type","logSuccess","email","payload","logFailure","msg","clearMsg","logout","localStorage","clear","window","location","reload","login","username","password","dispatch","authenticationData","Username","Password","console","log","authDetails","userData","Pool","congnitoUser","authenticateUser","onSuccess","result","setItem","JSON","stringify","accessToken","jwtToken","error","setTimeout"],"sources":["/Users/willsegura/Documents/comercio/src/redux/actions/loginActions.jsx"],"sourcesContent":["import {\n\tloginRequest,\n\tloginSuccess,\n\tloginFailure,\n\tclearMessage,\n\tloginLogout,\n} from '../types/loginTypes';\nimport {\n\tAuthenticationDetails,\n\tCognitoUser,\n\tCognitoUserSession,\n\tCognitoUserPool\n  } from \"amazon-cognito-identity-js\";\n//   import UseHandler from \"../../config/UseHandler\";\n  const Pool_Data = {\n    UserPoolId: 'us-east-1_WN7mX5v6o', // Your user pool id here\n    ClientId: '556ootgckn7idfhepo7c0up52g',\n};\nconst userPool = new CognitoUserPool(Pool_Data)\nconst logRequest = () => {\n\treturn {\n\t\ttype: loginRequest,\n\t};\n};\nconst logSuccess = email => {\n\treturn {\n\t\ttype: loginSuccess,\n\t\tpayload: email,\n\t};\n};\nconst logFailure = msg => {\n\treturn {\n\t\ttype: loginFailure,\n\t\tpayload: msg,\n\t};\n};\nconst clearMsg = () => {\n\treturn {\n\t\ttype: clearMessage,\n\t};\n};\nexport const logout = () => {\n\tlocalStorage.clear();\n\twindow.location.reload();\n\treturn {\n\t\ttype: loginLogout,\n\t};\n};\n\nexport const login = (username, password) => async dispatch => {\n\tdispatch(logRequest());\n\ttry {\n\t\tconst authenticationData = {\n\t\t\tUsername: username,\n\t\t\tPassword: password\n\t\t  };\n\t\t  console.log(authenticationData);\n\t\tconst authDetails = new AuthenticationDetails(authenticationData);//Encapsula todos los datos necesarios para autenticar a un usuario. \n\t\t//Pase un objeto de este tipo al objeto de continuación para continuar con el proceso de autenticación. Este contenido de este objeto se establece cuando se construye y es inmutable después.\n\t\tconst userData = {\n\t\tUsername: username,\n\t\tPool: userPool\n\t\t};\n\t\tconst congnitoUser = new CognitoUser(userData);\n\t\tcongnitoUser.authenticateUser(authDetails, {\n\t\t\t\n\t\t\tonSuccess(result: CognitoUserSession) { //me da una sesión, de la que puedo obtener un jwtToken\n\t\t\t  console.log(result);\n\t\t\t  console.log(CognitoUserSession);\n\t\tlocalStorage.setItem('Token', JSON.stringify(result.accessToken.jwtToken));\n\t\tlocalStorage.setItem('isAuthenticated', true);\n\t\tlocalStorage.setItem('data', JSON.stringify(result));\n\t\t\t  dispatch(logSuccess(result));\n\t\t\t},\n\t\t  });\n\t} catch (error) {\n\t\t\tdispatch(logFailure(error));\n\t\t\tsetTimeout(() => {\n\t\t\t\tdispatch(clearMsg());\n\t\t\t}, 3000);\n\t}\n};\n"],"mappings":"oQAAA,OACCA,YAAY,CACZC,YAAY,CACZC,YAAY,CACZC,YAAY,CACZC,WAAW,KACL,qBAAqB,CAC5B,OACCC,qBAAqB,CACrBC,WAAW,CACXC,kBAAkB,CAClBC,eAAe,KACP,4BAA4B,CACrC;AACE,GAAMC,UAAS,CAAG,CAChBC,UAAU,CAAE,qBAAqB,CAAE;AACnCC,QAAQ,CAAE,4BACd,CAAC,CACD,GAAMC,SAAQ,CAAG,GAAIJ,gBAAe,CAACC,SAAS,CAAC,CAC/C,GAAMI,WAAU,CAAG,QAAbA,WAAU,EAAS,CACxB,MAAO,CACNC,IAAI,CAAEd,YACP,CAAC,CACF,CAAC,CACD,GAAMe,WAAU,CAAG,QAAbA,WAAU,CAAGC,KAAK,CAAI,CAC3B,MAAO,CACNF,IAAI,CAAEb,YAAY,CAClBgB,OAAO,CAAED,KACV,CAAC,CACF,CAAC,CACD,GAAME,WAAU,CAAG,QAAbA,WAAU,CAAGC,GAAG,CAAI,CACzB,MAAO,CACNL,IAAI,CAAEZ,YAAY,CAClBe,OAAO,CAAEE,GACV,CAAC,CACF,CAAC,CACD,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,EAAS,CACtB,MAAO,CACNN,IAAI,CAAEX,YACP,CAAC,CACF,CAAC,CACD,MAAO,IAAMkB,OAAM,CAAG,QAATA,OAAM,EAAS,CAC3BC,YAAY,CAACC,KAAK,EAAE,CACpBC,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CACxB,MAAO,CACNZ,IAAI,CAAEV,WACP,CAAC,CACF,CAAC,CAED,MAAO,IAAMuB,MAAK,CAAG,QAARA,MAAK,CAAIC,QAAQ,CAAEC,QAAQ,mGAAK,iBAAMC,QAAQ,4KAC1DA,QAAQ,CAACjB,UAAU,EAAE,CAAC,CACtB,GAAI,CACGkB,kBAAkB,CAAG,CAC1BC,QAAQ,CAAEJ,QAAQ,CAClBK,QAAQ,CAAEJ,QACT,CAAC,CACDK,OAAO,CAACC,GAAG,CAACJ,kBAAkB,CAAC,CAC3BK,WAAW,CAAG,GAAI/B,sBAAqB,CAAC0B,kBAAkB,CAAC,CAAC;AAClE;AACMM,QAAQ,CAAG,CACjBL,QAAQ,CAAEJ,QAAQ,CAClBU,IAAI,CAAE1B,QACN,CAAC,CACK2B,YAAY,CAAG,GAAIjC,YAAW,CAAC+B,QAAQ,CAAC,CAC9CE,YAAY,CAACC,gBAAgB,CAACJ,WAAW,CAAE,CAE1CK,SAAS,oBAACC,MAA0B,CAAE,CAAE;AACtCR,OAAO,CAACC,GAAG,CAACO,MAAM,CAAC,CACnBR,OAAO,CAACC,GAAG,CAAC5B,kBAAkB,CAAC,CAClCe,YAAY,CAACqB,OAAO,CAAC,OAAO,CAAEC,IAAI,CAACC,SAAS,CAACH,MAAM,CAACI,WAAW,CAACC,QAAQ,CAAC,CAAC,CAC1EzB,YAAY,CAACqB,OAAO,CAAC,iBAAiB,CAAE,IAAI,CAAC,CAC7CrB,YAAY,CAACqB,OAAO,CAAC,MAAM,CAAEC,IAAI,CAACC,SAAS,CAACH,MAAM,CAAC,CAAC,CACjDZ,QAAQ,CAACf,UAAU,CAAC2B,MAAM,CAAC,CAAC,CAC9B,CACC,CAAC,CAAC,CACL,CAAE,MAAOM,KAAK,CAAE,CACdlB,QAAQ,CAACZ,UAAU,CAAC8B,KAAK,CAAC,CAAC,CAC3BC,UAAU,CAAC,UAAM,CAChBnB,QAAQ,CAACV,QAAQ,EAAE,CAAC,CACrB,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,qDACD"},"metadata":{},"sourceType":"module","externalDependencies":[]}